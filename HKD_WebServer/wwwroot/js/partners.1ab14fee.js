(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["partners"],{"00ee":function(t,e,a){"use strict";var s=a("e80d"),i=a.n(s);i.a},"19b0":function(t,e,a){},"86f5":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{staticClass:"funnyback"},[a("v-card-text",[a("Table",{attrs:{headers:t.headers,items:t.items,status:t.status,error:t.error},scopedSlots:t._u([{key:"top",fn:function(){return[a("v-toolbar",{attrs:{flat:"",color:"white"}},[a("p",{staticClass:"subtitle-2 font-italic font-weight-medium"},[t._v("\n            Название редактируется в таблице. Сохраняется по кнопке enter!\n          ")]),a("div",{staticClass:"flex-grow-1"}),a("v-dialog",{attrs:{persistent:t.changed},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on;return[a("v-btn",t._g({attrs:{text:"",disabled:t.editor||t.changed||t.wait},on:{click:t.setEditor}},s),[t._v("\n                Добавить\n              ")])]}}]),model:{value:t.addDialog.visible,callback:function(e){t.$set(t.addDialog,"visible",e)},expression:"addDialog.visible"}},[a("EditPartner",{attrs:{save:t.save,status:t.localStatus},on:{"update:status":function(e){t.localStatus=e},endEdited:function(e){t.addDialog.visible=!1,t.addDialog.item={}}},model:{value:t.addDialog.item,callback:function(e){t.$set(t.addDialog,"item",e)},expression:"addDialog.item"}})],1)],1)]},proxy:!0},{key:"item.Name",fn:function(e){var s=e.item;return[a("EditField",{attrs:{save:t.save,params:[s],status:t.localStatus},on:{"update:status":function(e){t.localStatus=e}},model:{value:s.Name,callback:function(e){t.$set(s,"Name",e)},expression:"item.Name"}},[t._v(" "+t._s(s.Name)+"\n        ")])]}},{key:"item.action",fn:function(e){var s=e.item;return[a("v-btn",{attrs:{icon:""},on:{click:function(e){return t.viewItem(s)}}},[a("v-icon",[t._v("mdi-eye")])],1)]}}])}),t.ready?a("router-view"):t._e()],1)],1)},i=[],n=a("2f62"),r=a("702d"),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{on:{click:t.select}},[t.edit?a("div",[t.wait?a("p",{staticStyle:{margin:"0"}},[t._v("Сохраняем...")]):a("v-text-field",{staticClass:"editor_table",attrs:{"hide-details":"","single-line":"",dense:"",disabled:t.wait},on:{keyup:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.save_local(e)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.cancel(e)},t.change]},scopedSlots:t._u([{key:"append-outer",fn:function(){return[a("v-btn",{attrs:{icon:"",disabled:t.wait},on:{click:function(e){return e.stopPropagation(),t.cancel(e)}}},[a("v-icon",{staticStyle:{cursor:"pointer"},attrs:{color:"warning"}},[t._v("mdi-cancel")])],1),a("v-btn",{attrs:{icon:"",disabled:t.wait},on:{click:function(e){return e.stopPropagation(),t.save_local(e)}}},[a("v-icon",{staticStyle:{cursor:"pointer"},attrs:{color:"primary"}},[t._v("mdi-content-save")])],1)]},proxy:!0}]),model:{value:t.editing_value,callback:function(e){t.editing_value=e},expression:"editing_value"}})],1):a("div",{staticClass:"wrapper"},[t._t("default")],2)])},c=[],l=a("4360"),d={name:"EditDialog",props:{value:String,status:Number,save:Function,params:{type:Array,default:()=>[]}},data:()=>({edit:!1,editing_value:""}),computed:{wait(){return this.status===l["b"].WAIT}},methods:{select(){~[l["b"].CHANGED,l["b"].EDITOR,l["b"].WAIT].indexOf(this.status)||(this.$emit("update:status",l["b"].EDITOR),this.editing_value=this.value,this.edit=!0)},close(){this.edit=!1,this.$emit("update:status",l["b"].VIEW)},async cancel(){this.status===l["b"].CHANGED?await this.$modal.confirm("У вас есть несохраненные изменения, точно закрыть?")&&this.close():this.close()},change(){this.$emit("update:status",l["b"].CHANGED)},save_local(){this.status===l["b"].CHANGED&&(this.$emit("update:status",l["b"].WAIT),this.save(this.editing_value,...this.params).then(()=>{this.close()}))}}},u=d,v=(a("b81a"),a("2877")),m=a("6544"),h=a.n(m),b=a("8336"),p=a("132d"),f=a("8654"),E=Object(v["a"])(u,o,c,!1,null,"df75d5d8",null),_=E.exports;h()(E,{VBtn:b["a"],VIcon:p["a"],VTextField:f["a"]});var g=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-title",[t._v("\n    Создание партнера\n  ")]),a("v-card-text",[a("v-text-field",{attrs:{disabled:t.wait,label:"Имя","single-line":""},on:{keyup:t.change},model:{value:t.value.Name,callback:function(e){t.$set(t.value,"Name",e)},expression:"value.Name"}})],1),a("v-card-actions",[a("div",{staticClass:"flex-grow-1"}),a("v-btn",{attrs:{disabled:t.wait,color:"primary",text:""},on:{click:t.save_local}},[t._v("\n      Сохранить\n    ")]),a("v-btn",{attrs:{disabled:t.wait,color:"primary",text:""},on:{click:t.cancel}},[t._v("\n      Закрыть\n    ")])],1)],1)},w=[],y={name:"EditDialog",props:{value:Object,status:Number,save:Function,params:{type:Array,default:()=>[]}},data:()=>({}),computed:{wait(){return this.status===l["b"].WAIT}},methods:{select(){~[l["b"].CHANGED,l["b"].EDITOR,l["b"].WAIT].indexOf(this.status)||this.$emit("update:status",l["b"].EDITOR)},close(){this.$emit("update:status",l["b"].VIEW),this.$emit("endEdited")},async cancel(){this.status===l["b"].CHANGED?await this.$modal.confirm("У вас есть несохраненные изменения, точно закрыть?")&&this.close():this.close()},change(){this.$emit("update:status",l["b"].CHANGED)},save_local(){this.status===l["b"].CHANGED&&(this.$emit("update:status",l["b"].WAIT),this.save(this.value,...this.params).then(()=>{this.close()}))}}},C=y,I=a("b0af"),x=a("99d9"),T=Object(v["a"])(C,g,w,!1,null,null,null),V=T.exports;h()(T,{VBtn:b["a"],VCard:I["a"],VCardActions:x["a"],VCardText:x["b"],VCardTitle:x["c"],VTextField:f["a"]});var D={data:()=>({localStatus:l["b"].VIEW}),computed:{view(){return this.localStatus===l["b"].VIEW},editor(){return this.localStatus===l["b"].EDITOR},changed(){return this.localStatus===l["b"].CHANGED},wait(){return this.localStatus===l["b"].WAIT}},methods:{setView(){return this.localStatus=l["b"].VIEW},setEditor(){return this.localStatus=l["b"].EDITOR},setChanged(){return this.localStatus=l["b"].CHANGED},setWait(){return this.localStatus=l["b"].WAIT}},async beforeRouteLeave(t,e,a){if(this.changed||this.wait){const t=await this.$modal.confirm("Вы хотите уйти? У вас есть несохранённые изменения!");t&&(this.setView(),a())}else a(),this.setView()}},$={mixins:[D],components:{Table:r["a"],EditField:_,EditPartner:V},data:()=>({addDialog:{visible:!1,item:{Name:""}},headers:[{text:"Id",value:"Id"},{text:"Наименование",value:"Name"},{sortable:!1,value:"action",width:1}]}),computed:{...Object(n["d"])("partners",["status","error","items"]),ready(){return this.status===l["c"].READY}},mounted(){Promise.all([this.GET_ITEMS()]),this.status===l["c"].READY&&this.setView()},methods:{...Object(n["b"])("partners",["GET_ITEMS","SAVE_ITEM","CREATE_ITEM"]),async save(t,e){try{const s=Object.assign({},e);s.Name=t,await this.SAVE_ITEM(s),this.$bus.$emit("sendSuccess","Сохранено")}catch(a){console.log(a),this.$bus.$emit("sendError",a.message)}},async viewItem(t){this.$router.push({name:"partner",params:{id:t.Id}})},async createItem(){try{await this.CREATE_ITEM(this.addDialog.item),this.$bus.$emit("sendSuccess","Сохранено"),this.addDialog.visible=!1,this.addDialog.item={}}catch(t){console.log(t),this.$bus.$emit("sendError",t.message)}}}},k=$,S=(a("00ee"),a("169a")),A=a("71d9"),N=Object(v["a"])(k,s,i,!1,null,"a3afff2a",null);e["default"]=N.exports;h()(N,{VBtn:b["a"],VCard:I["a"],VCardText:x["b"],VDialog:S["a"],VIcon:p["a"],VToolbar:A["a"]})},b81a:function(t,e,a){"use strict";var s=a("19b0"),i=a.n(s);i.a},e80d:function(t,e,a){},e95f:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{attrs:{value:t.visible},on:{input:t.close}},[t.wait?a("v-card",[a("v-card-text",[a("Spinner")],1)],1):a("v-card",[a("v-card-title",[t._v("\n      Партнер: "+t._s(t.item.Name)+"\n    ")]),a("v-card-text",[a("v-container",[a("v-row",[a("v-col",{staticClass:"py-0",attrs:{cols:"6"}},[a("v-row",[a("v-col",{attrs:{cols:"6"}},[t._v("\n                Количество цессий:\n              ")]),a("v-col",{attrs:{cols:"6"}},[t._v("\n                "+t._s(t.item.cessionsCount)+"\n              ")])],1),a("v-row",[a("v-col",{staticClass:"py-0",attrs:{cols:"6"}},[t._v("\n                Количество запросов:\n              ")]),a("v-col",{staticClass:"py-0",attrs:{cols:"6"}},[t._v("\n                "+t._s(t.item.queryCount)+"\n              ")])],1)],1),a("v-col",{staticClass:"py-0",attrs:{cols:"6"}},[a("v-row",[a("v-col",{attrs:{cols:"6"}},[t._v("\n                Количество договоров:\n              ")]),a("v-col",{attrs:{cols:"6"}},[t._v("\n                "+t._s(t.item.contractsCount)+"\n              ")])],1)],1)],1),a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-data-table",{attrs:{headers:t.headers,items:t.item.cessionsStatisticsPartner},scopedSlots:t._u([{key:"item.action",fn:function(e){var s=e.item;return[a("v-btn",{attrs:{icon:""},on:{click:function(e){return t.viewCession(s)}}},[a("v-icon",[t._v("mdi-eye")])],1)]}}])})],1)],1)],1)],1),a("v-card-actions",[a("div",{staticClass:"flex-grow-1"}),a("v-btn",{attrs:{color:"primary",text:""},on:{click:t.close}},[t._v("\n        Закрыть\n      ")])],1)],1)],1)},i=[],n=a("4360"),r=a("1462"),o=a("2f62"),c={components:{Spinner:r["a"]},data:()=>({headers:[{text:"Номер цессии",value:"Name"},{text:"Кол-во сканов цессии",value:"CessionScansCount"},{text:"Кол-во кредитных договоров",value:"contractsCount"},{text:"Договоров без сканов",value:"contractsCountWithoutScans"},{sortable:!1,value:"action",width:1}],visible:!1}),computed:{...Object(o["c"])("partners",["getById"]),...Object(o["d"])("partners",["status","error"]),id(){return parseInt(this.$route.params.id)},item(){return this.getById(this.id)},wait(){return this.status===n["c"].WAIT}},async mounted(){this.visible=!0;try{await this.GET_ITEM(this.id)}catch(t){this.$bus.$emit("sendError",t.message)}},methods:{...Object(o["b"])("partners",["GET_ITEM"]),viewCession(t){this.$router.push({name:"cession",params:{id:t.Id}})},close(){this.$router.push({name:"partners"})}}},l=c,d=a("2877"),u=a("6544"),v=a.n(u),m=a("8336"),h=a("b0af"),b=a("99d9"),p=a("62ad"),f=a("a523"),E=a("8fea"),_=a("169a"),g=a("132d"),w=a("0fd9"),y=Object(d["a"])(l,s,i,!1,null,null,null);e["default"]=y.exports;v()(y,{VBtn:m["a"],VCard:h["a"],VCardActions:b["a"],VCardText:b["b"],VCardTitle:b["c"],VCol:p["a"],VContainer:f["a"],VDataTable:E["a"],VDialog:_["a"],VIcon:g["a"],VRow:w["a"]})}}]);
//# sourceMappingURL=partners.1ab14fee.js.map